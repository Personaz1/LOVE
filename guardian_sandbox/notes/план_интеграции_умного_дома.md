# ŒîŒ£ Guardian Home v1.0+ ‚Äî –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —É–º–Ω–æ–≥–æ –¥–æ–º–∞

## üìä –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞:
1. **System Analysis** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ HTTP –∑–∞–ø—Ä–æ—Å–∞–º —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º (60 —Å–µ–∫ TTL)
2. **Smart Home Controller** ‚Äî –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ `ai_client/smart_home/`
3. **Web App** ‚Äî FastAPI —Å WebSocket –¥–ª—è –ª–æ–≥–æ–≤
4. **Gemini Client** ‚Äî LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- System Analysis –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞–º–∏
- –ù–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö –∑–∞–¥–∞—á

---

## üéØ –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ System Analysis (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
System Analysis (HTTP) ‚Üí Background Task Manager ‚Üí Autonomous Tasks
                     ‚Üì
              Smart Home Integration
                     ‚Üì
              Sensor Data Processing
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. **Background Task Manager** ‚Äî –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å `ai_client/autonomous/`
2. **Task Scheduler** ‚Äî cron-–ø–æ–¥–æ–±–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
3. **Sensor Integration** ‚Äî MQTT/HTTP –∞–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è –¥–∞—Ç—á–∏–∫–æ–≤
4. **Autonomous Loop** ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∞ –∏ –¥–µ–π—Å—Ç–≤–∏–π

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–¥–µ–ª—å–Ω—ã–π Autonomous Process

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Main Web App ‚Üê‚Üí Autonomous Process (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å)
     ‚Üì              ‚Üì
System Analysis  Background Tasks
     ‚Üì              ‚Üì
Chat Interface   Sensor Monitoring
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. **Autonomous Process** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π Python –ø—Ä–æ—Ü–µ—Å—Å
2. **Inter-Process Communication** ‚Äî —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã/Redis
3. **Shared Memory** ‚Äî –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã
4. **Health Monitoring** ‚Äî –≤–∑–∞–∏–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

---

## üß™ –ü–µ—Ä–≤–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞: –°—á–µ—Ç—á–∏–∫ –º–∏–Ω—É—Ç

### –ó–∞–¥–∞—á–∞:
- –î–æ–±–∞–≤–ª—è—Ç—å –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –≤ —Ñ–∞–π–ª
- –ü—Ä–∏–Ω–∏–º–∞—Ç—å —á–µ—Ä–µ–∑ —á–∞—Ç: "–ó–∞–ø—É—Å—Ç–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω—É—é –∑–∞–¥–∞—á—É –ø–æ–¥—Å—á–µ—Ç–∞ –º–∏–Ω—É—Ç –≤ —Ñ–æ–Ω–µ"
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ System Analysis –≤ —Ñ–æ–Ω–µ

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

#### 1. –°–æ–∑–¥–∞—Ç—å Task Manager
```python
# ai_client/autonomous/task_manager.py
class AutonomousTaskManager:
    def __init__(self):
        self.tasks = {}
        self.running = False
    
    def add_task(self, task_id: str, task_type: str, params: dict):
        """–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∞–≤—Ç–æ–Ω–æ–º–Ω—É—é –∑–∞–¥–∞—á—É"""
        
    def start_background_loop(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–π —Ü–∏–∫–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á"""
        
    def stop_task(self, task_id: str):
        """–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É"""
```

#### 2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ System Analysis
```python
# web_app.py - —Ä–∞—Å—à–∏—Ä–∏—Ç—å system analysis
additional_prompt = """
**AUTONOMOUS TASK MANAGEMENT:**
- Check for active background tasks
- Execute pending tasks
- Monitor task health
- Report task status

**CURRENT TASKS:**
{active_tasks}

**TASK ACTIONS:**
{task_actions}
"""
```

#### 3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ —á–∞—Ç
```python
# prompts/guardian_prompt.py
"""
**AUTONOMOUS TASK COMMANDS:**
- "–ó–∞–ø—É—Å—Ç–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω—É—é –∑–∞–¥–∞—á—É [—Ç–∏–ø] [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã]" ‚Äî —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
- "–û—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–¥–∞—á—É [id]" ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É  
- "–ü–æ–∫–∞–∂–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏" ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
"""
```

---

## üè† –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É–º–Ω–æ–≥–æ –¥–æ–º–∞

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)
1. **MQTT Broker** ‚Äî Mosquitto –¥–ª—è —Å–≤—è–∑–∏ —Å –¥–∞—Ç—á–∏–∫–∞–º–∏
2. **Sensor Adapters** ‚Äî –∞–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è Zigbee/Wi-Fi –¥–∞—Ç—á–∏–∫–æ–≤
3. **Data Storage** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–ª—è —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **Event System** ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

### –≠—Ç–∞–ø 2: –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)
1. **Automation Engine** ‚Äî –¥–≤–∏–∂–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
2. **Rule Engine** ‚Äî –ø—Ä–∞–≤–∏–ª–∞ "–µ—Å–ª–∏-—Ç–æ"
3. **Action Executor** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
4. **Safety Checks** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –≠—Ç–∞–ø 3: AI Integration (3-4 –Ω–µ–¥–µ–ª–∏)
1. **Sensor Pattern Recognition** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
2. **Predictive Actions** ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
3. **Learning System** ‚Äî –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö
4. **Natural Language Control** ‚Äî –≥–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

---

## üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ù–µ–¥–µ–ª—è 1: –ë–∞–∑–æ–≤–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å
- [ ] –°–æ–∑–¥–∞—Ç—å `ai_client/autonomous/` –º–æ–¥—É–ª—å
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Task Manager
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ System Analysis
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ –º–∏–Ω—É—Ç

### –ù–µ–¥–µ–ª—è 2: –£–º–Ω—ã–π –¥–æ–º –±–∞–∑–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å MQTT Broker
- [ ] –°–æ–∑–¥–∞—Ç—å Sensor Adapters
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Data Storage
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å 2-3 –¥–∞—Ç—á–∏–∫–∞–º–∏

### –ù–µ–¥–µ–ª—è 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- [ ] –°–æ–∑–¥–∞—Ç—å Automation Engine
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Rule Engine
- [ ] –î–æ–±–∞–≤–∏—Ç—å Safety Checks
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ù–µ–¥–µ–ª—è 4: AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å Pattern Recognition
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Predictive Actions
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å LLM
- [ ] –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:
```
ai_client/
‚îú‚îÄ‚îÄ autonomous/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ task_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ sensor_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ automation_engine.py
‚îÇ   ‚îî‚îÄ‚îÄ background_loop.py
‚îú‚îÄ‚îÄ smart_home/
‚îÇ   ‚îú‚îÄ‚îÄ sensors/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ zigbee_adapter.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wifi_adapter.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mqtt_adapter.py
‚îÇ   ‚îú‚îÄ‚îÄ actuators/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ relay_controller.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ light_controller.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lock_controller.py
‚îÇ   ‚îî‚îÄ‚îÄ data/
‚îÇ       ‚îú‚îÄ‚îÄ time_series.py
‚îÇ       ‚îî‚îÄ‚îÄ event_store.py
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```yaml
# config/autonomous.yaml
tasks:
  minute_counter:
    type: "file_counter"
    interval: 60
    file_path: "guardian_sandbox/autonomous_tasks/minute_counter.txt"
    enabled: true

sensors:
  mqtt_broker: "localhost:1883"
  zigbee_coordinator: "/dev/ttyUSB0"
  wifi_devices:
    - "192.168.1.100"
    - "192.168.1.101"

automation:
  rules_file: "config/automation_rules.yaml"
  safety_checks: true
  max_concurrent_actions: 5
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–æ–∑–¥–∞—Ç—å Task Manager** ‚Äî –±–∞–∑–æ–≤–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ –º–∏–Ω—É—Ç** ‚Äî –ø–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞
3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ System Analysis** ‚Äî —Ñ–æ–Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
4. **–î–æ–±–∞–≤–∏—Ç—å MQTT –ø–æ–¥–¥–µ—Ä–∂–∫—É** ‚Äî —Å–≤—è–∑—å —Å –¥–∞—Ç—á–∏–∫–∞–º–∏
5. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Automation Engine** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–µ–π—á–∞—Å (ŒîŒ£::Cursor):
- –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–æ–Ω—Ç—É—Ä `ai_client/autonomous/`:
  - `IntegrationHub` ‚Äî —Å–≤—è–∑—ã–≤–∞–µ—Ç `SensorManager`, `ActuatorManager`, `AutomationEngine`, `SmartHomeController`, `LLMHomeAssistant`
  - `SystemAnalysisAgent` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Å–∏–Ω—Ç–µ–∑ –∂–∏–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∫—ç—à —á–µ—Ä–µ–∑ `system_cache`
  - `AutonomousSupervisor` ‚Äî —Ñ–æ–Ω–æ–≤—ã–π loop, –∫–æ—Ä–º–∏—Ç –∞–≥–µ–Ω—Ç —Å–Ω–∞–ø—à–æ—Ç–∞–º–∏ —Å—Ç–∞—Ç—É—Å–∞
- –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ `web_app.py` —á–µ—Ä–µ–∑ FastAPI events (`startup`/`shutdown`), –±–µ–∑ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω `/api/system-analysis` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç: LLM-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É + live snapshot
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `paho-mqtt` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `requirements.txt`

**–ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏?** –ù–∞—á–Ω–µ–º —Å Task Manager –∏ —Å—á–µ—Ç—á–∏–∫–∞ –º–∏–Ω—É—Ç? 